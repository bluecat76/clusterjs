!function(a,b){function c(a,b,c,d,e,f){this.id=a,this.x=b,this.y=c,this.size=d,this.dx=e,this.dy=f}function d(b,d){var e=[b],f=function(a){return a*a},g=function(b){var d="cl",e=0,f=0,g=b.length,h=0;return a.each(b,function(a,b){d+="_"+b.id,e+=b.x,f+=b.y,h+=b.size}),new c(d,e/g,f/g,h)},h=f(d);this.value=b,this.prev=null,this.next=null,this.contains=function(a){return f(a.value.x-this.value.x)+f(a.value.y-this.value.y)<h},this.larger=function(a){return this.value.x>a.value.x},this.add=function(a){e.push(a.value),this.value=g(e)},this.getValues=function(){var a=[this.value];return this.prev&&a.push.apply(a,this.prev.getValues()),this.next&&a.push.apply(a,this.next.getValues()),a}}function e(b,c){var e=null,f=function(a){var b=e;if(!b)return e=a,void 0;for(;b;){if(b.contains(a))return b.add(a),void 0;if(b.larger(a)){if(!b.next)return b.next=a,void 0;b=b.next}else{if(!b.prev)return b.prev=a,void 0;b=b.prev}}alert("does not happen, or does it?")};this.getPoints=function(){return e.getValues()},a.each(b,function(a,b){f(new d(b,c))})}function f(d,f){var g=a(d),h=g.width(),i=g.height(),j=function(a){return parseInt(a,10)+"px"},k=function(a,b,d){var e,f=2*b,g=[];for(e=0;a>e;e+=1)g.push(new c("pt"+e,Math.random()*h,Math.random()*i,d,(.5-Math.random())*f,(.5-Math.random())*f));return g},l=function(b){a.each(b,function(a,b){b.x+=b.dx,b.y+=b.dy,b.x>h&&(b.dx*=-1,b.x=2*h-b.x),b.x<0&&(b.dx*=-1,b.x=-b.x),b.y>i&&(b.dy*=-1,b.y=2*i-b.y),b.y<0&&(b.dy*=-1,b.y=-b.y)})},m=function(a){var b=new e(a,f.distance);return b.getPoints()},n=function(){a("div",g).remove()},o=function(b){a.each(b,function(b,c){var d=c.size,e=2*d+1;a('<div class="pt" id="'+c.id+'">').css({left:j(c.x-d),top:j(c.y-d),width:j(e),height:j(e)}).appendTo(g)})},p=k(f.count,f.speed,f.size),q=function(){n(),o(m(p)),l(p),b.setTimeout(function(){q()},40)};q()}a.fn.cluster=function(b){return this.each(function(){var c=a.data(this,"cluster");c?c[b].apply(c,Array.prototype.slice.call(arguments,1)):a.data(this,"cluster",new f(this,b))})}}(jQuery,this);